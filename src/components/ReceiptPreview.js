import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { forwardRef } from 'react';
import { getTranslation, formatMoney } from '../services/translationService';
const DocumentPreview = forwardRef(({ data, captureId = "receipt-capture-area" }, ref) => {
    const lang = data.language || 'pt';
    const currency = data.currency || 'MZN';
    const t = (key) => getTranslation(lang, key);
    const getStampStyle = (text) => {
        const base = "border-[6px] px-6 py-2 rounded-xl font-black text-6xl uppercase tracking-[0.2em] opacity-30 mix-blend-multiply transform -rotate-12 border-double whitespace-nowrap";
        const textLower = text.toLowerCase();
        if (['pago', 'paid', 'pagado', 'payé', 'bezahlt'].some(w => textLower.includes(w)))
            return `${base} border-emerald-700 text-emerald-700`;
        if (['emitido', 'issued', 'emitida', 'émis', 'ausgestellt'].some(w => textLower.includes(w)))
            return `${base} border-blue-700 text-blue-700`;
        if (['pendente', 'pending', 'vencido', 'overdue', 'anulado', 'void', 'annulé'].some(w => textLower.includes(w)))
            return `${base} border-red-700 text-red-700`;
        return `${base} border-slate-700 text-slate-700`;
    };
    let title = t('receipt');
    if (data.type === 'INVOICE')
        title = t('invoice');
    if (data.type === 'QUOTE')
        title = t('quote');
    // Fallback para nome da empresa caso esteja vazio
    const displayCompanyName = data.companyName || 'BIZ-FLOW';
    return (_jsxs("div", { ref: ref, id: captureId, className: "relative bg-white text-slate-900 font-sans leading-relaxed overflow-hidden", style: {
            width: '210mm',
            minHeight: '297mm',
            padding: '25mm',
            boxSizing: 'border-box',
            backgroundColor: '#ffffff',
            display: 'flex',
            flexDirection: 'column'
        }, children: [_jsx("div", { className: "h-3 bg-slate-900 w-full mb-12 flex-none" }), _jsxs("div", { className: "w-full mb-16 flex justify-between items-start", children: [_jsxs("div", { className: "w-1/2", children: [data.companyLogo ? (_jsx("img", { src: data.companyLogo, alt: "Logo", className: "h-24 w-auto mb-6 object-contain" })) : (_jsx("div", { className: "mb-6", children: _jsx("h2", { className: "font-black text-4xl text-slate-900 tracking-tighter uppercase", children: displayCompanyName }) })), _jsxs("div", { className: "text-[13px] text-slate-500 space-y-1 leading-tight font-medium", children: [data.companyAddress && _jsxs("p", { className: "flex items-start gap-2", children: [_jsx("span", { className: "opacity-40", children: "\u25CF" }), " ", data.companyAddress] }), data.companyContact && _jsxs("p", { className: "flex items-start gap-2", children: [_jsx("span", { className: "opacity-40", children: "\u25CF" }), " ", data.companyContact] }), data.companyNuit && _jsxs("p", { className: "flex items-start gap-2", children: [_jsx("span", { className: "opacity-40", children: "\u25CF" }), " ", t('taxId'), ": ", data.companyNuit] })] })] }), _jsxs("div", { className: "text-right", children: [_jsx("h1", { className: "text-6xl font-black text-slate-900 tracking-tighter mb-2 uppercase", children: title }), _jsxs("div", { className: "text-2xl font-mono text-slate-400 mb-6", children: ["#", data.number || '0000'] }), _jsxs("div", { className: "text-[13px] font-bold text-slate-800", children: [_jsxs("span", { className: "text-slate-400 uppercase tracking-widest mr-2", children: [t('date'), ":"] }), data.date] })] })] }), data.stampText && (_jsx("div", { className: "absolute top-[160px] right-[40px] z-0 pointer-events-none select-none", children: _jsx("div", { className: getStampStyle(data.stampText), children: data.stampText }) })), _jsxs("div", { className: "mb-14 pt-8 border-t border-slate-100", children: [_jsx("h3", { className: "text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-4", children: t('billedTo') }), _jsxs("div", { className: "text-slate-900", children: [_jsx("div", { className: "font-black text-2xl mb-2", children: data.clientName || '---' }), _jsxs("div", { className: "text-sm text-slate-600 max-w-md space-y-1", children: [data.clientLocation && _jsx("p", { children: data.clientLocation }), data.clientContact && _jsx("p", { children: data.clientContact }), data.clientNuit && _jsxs("p", { className: "font-mono text-xs opacity-70", children: [t('taxId'), ": ", data.clientNuit] })] })] })] }), _jsx("div", { className: "mb-12 flex-grow", children: _jsxs("table", { className: "w-full text-left", style: { tableLayout: 'fixed' }, children: [_jsx("thead", { children: _jsxs("tr", { className: "border-b-2 border-slate-900 text-slate-900", children: [_jsx("th", { className: "py-4 text-[11px] font-black uppercase tracking-widest", style: { width: '45%' }, children: t('description') }), _jsx("th", { className: "py-4 text-[11px] font-black uppercase tracking-widest text-center", style: { width: '15%' }, children: t('qty') }), _jsx("th", { className: "py-4 text-[11px] font-black uppercase tracking-widest text-right", style: { width: '20%' }, children: t('price') }), _jsx("th", { className: "py-4 text-[11px] font-black uppercase tracking-widest text-right", style: { width: '20%' }, children: t('total') })] }) }), _jsx("tbody", { className: "text-[14px]", children: data.items && data.items.length > 0 ? (data.items.map((item) => (_jsxs("tr", { className: "border-b border-slate-100", children: [_jsx("td", { className: "py-5 pr-4 align-top", children: _jsx("p", { className: "font-bold text-slate-900", children: item.description }) }), _jsx("td", { className: "py-5 text-center align-top text-slate-600", children: item.quantity }), _jsx("td", { className: "py-5 text-right align-top text-slate-600 font-mono", children: formatMoney(item.unitPrice, currency) }), _jsx("td", { className: "py-5 text-right align-top font-bold text-slate-900 font-mono", children: formatMoney(item.total, currency) })] }, item.id)))) : (_jsx("tr", { children: _jsx("td", { className: "py-12 italic text-slate-300 text-center", colSpan: 4, children: "---" }) })) })] }) }), _jsxs("div", { className: "mt-auto", children: [_jsx("div", { className: "flex justify-end pt-4 mb-20", children: _jsxs("div", { className: "w-[300px] space-y-3", children: [_jsxs("div", { className: "flex justify-between text-[13px] text-slate-500", children: [_jsx("span", { children: t('subtotal') }), _jsx("span", { className: "font-mono", children: formatMoney(data.subtotal, currency) })] }), data.discount > 0 && (_jsxs("div", { className: "flex justify-between text-[13px] text-emerald-600", children: [_jsx("span", { children: t('discount') }), _jsxs("span", { className: "font-mono", children: ["- ", formatMoney(data.discount, currency)] })] })), data.taxRate > 0 && (_jsxs("div", { className: "flex justify-between text-[13px] text-slate-500", children: [_jsxs("span", { children: [t('tax'), " (", data.taxRate, "%)"] }), _jsx("span", { className: "font-mono", children: formatMoney(data.taxAmount, currency) })] })), _jsxs("div", { className: "flex justify-between pt-6 items-center", children: [_jsx("span", { className: "text-[11px] font-black uppercase tracking-[0.2em]", children: t('finalTotal') }), _jsx("div", { className: "bg-slate-900 text-white px-5 py-3 rounded-lg text-2xl font-black font-mono shadow-xl", children: formatMoney(data.total, currency) })] })] }) }), _jsxs("div", { className: "flex justify-between items-end border-t border-slate-100 pt-8 pb-8", children: [_jsxs("div", { className: "text-center w-[250px]", children: [_jsxs("div", { className: "h-20 flex flex-col justify-end items-center relative mb-2", children: [data.signatureData && (_jsx("img", { src: data.signatureData, alt: "Signature", className: "absolute bottom-1 max-h-24 max-w-full object-contain mix-blend-multiply" })), _jsx("div", { className: "w-full border-b border-slate-400" })] }), _jsx("p", { className: "text-[9px] text-slate-400 uppercase tracking-widest font-black", children: t('signature') })] }), _jsxs("div", { className: "text-right", children: [_jsx("p", { className: "text-[10px] font-black text-slate-200 uppercase tracking-widest mb-1", children: "Biz-flow.cloud" }), _jsxs("p", { className: "text-[9px] text-slate-400 font-bold", children: [t('generatedBy'), " \u2022 ", new Date().getFullYear()] })] })] })] })] }));
});
export default DocumentPreview;
